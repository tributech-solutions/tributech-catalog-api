{
  "openapi": "3.0.1",
  "info": {
    "title": "Tributech DataSpace Twin API",
    "description": "API for managing twin instances.",
    "version": "v1"
  },
  "paths": {
    "/graph": {
      "put": {
        "tags": ["Graph"],
        "summary": "Upsert digital twin graph.",
        "operationId": "UpsertTwinGraph",
        "requestBody": {
          "description": "The twin graph.",
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/TwinGraphFile"
              }
            },
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TwinGraphFile"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/TwinGraphFile"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/TwinGraphFile"
              }
            }
          }
        },
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/query/cypher": {
      "post": {
        "tags": ["Query"],
        "summary": "Query digital twin graph using cypher query.",
        "operationId": "GetTwinGraphByCypherQuery",
        "parameters": [
          {
            "name": "Match",
            "in": "query",
            "description": "Cypher query <a href=\"https://neo4j.com/docs/cypher-manual/current/clauses/match/\" target=\"_blank\">MATCH</a> part.\r\ne.g. \"(twin:Twin)\", \"(stream:Twin:BaseStreamTributechIoV1)\", \"(stream:Twin:BaseStreamTributechIoV1)-[relationship:Options]->(option:Twin:BaseOptionsTributechIoV1)\",...",
            "required": true,
            "schema": {
              "type": "string",
              "example": "(stream:Twin:BaseStreamTributechIoV1)-[relationship:Options]->(option:Twin:BaseOptionsTributechIoV1)"
            },
            "example": "(stream:Twin:BaseStreamTributechIoV1)-[relationship:Options]->(option:Twin:BaseOptionsTributechIoV1)"
          },
          {
            "name": "Where",
            "in": "query",
            "description": "(Optional) Cypher query <a href=\"https://neo4j.com/docs/cypher-manual/current/clauses/where/\" target=\"_blank\">WHERE</a> part.\r\ne.g. \"stream.ValueMetadataId = '6e02502-bfc5-4182-aa3b-891965020e14'\", \"stream.MerkleTreeDepth IS NOT NULL\", \"option:PersistenceOptionsTributechIoV1\",...",
            "schema": {
              "type": "string",
              "example": "option:PublishOptionsTributechIoV1 OR option:PersistenceOptionsTributechIoV1"
            },
            "example": "option:PublishOptionsTributechIoV1 OR option:PersistenceOptionsTributechIoV1"
          },
          {
            "name": "With",
            "in": "query",
            "description": "Cypher query <a href=\"https://neo4j.com/docs/cypher-manual/current/clauses/with/\" target=\"_blank\">WITH</a> part.\r\nThe result must be projected to lists named \"nodes\" and \"relationships\" to be returned which can be done at the WITH part.\r\nTo return an empty list for one of them you can use \"[] AS relationships\".\r\ne.g. \"stream AS nodes, [] AS relationships\", \"collect(distinct stream) + collect(distinct option) AS nodes, collect(relationship) AS relationships\"),...",
            "required": true,
            "schema": {
              "type": "string",
              "example": "collect(distinct stream) + collect(distinct option) AS nodes, collect(relationship) AS relationships"
            },
            "example": "collect(distinct stream) + collect(distinct option) AS nodes, collect(relationship) AS relationships"
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              }
            }
          }
        }
      }
    },
    "/query/subgraph": {
      "post": {
        "tags": ["Query"],
        "summary": "Query digital twin graph by criterias.",
        "operationId": "GetTwinGraphByQuery",
        "requestBody": {
          "description": "The graph query",
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/TwinGraphQuery"
              }
            },
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TwinGraphQuery"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/TwinGraphQuery"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/TwinGraphQuery"
              }
            }
          }
        },
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwinGraph"
                }
              }
            }
          }
        }
      }
    },
    "/outgoing/{dtId}": {
      "get": {
        "tags": ["Relationships"],
        "summary": "Get all outgoing relationships for a digital twin.",
        "operationId": "GetOutgoingRelationships",
        "parameters": [
          {
            "name": "dtId",
            "in": "path",
            "description": "The digital twin identifier.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Relationship"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Relationship"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Relationship"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/incoming/{dtId}": {
      "get": {
        "tags": ["Relationships"],
        "summary": "Get all incoming relationships for a digital twin.",
        "operationId": "GetIncomingRelationships",
        "parameters": [
          {
            "name": "dtId",
            "in": "path",
            "description": "The digital twin identifier.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Relationship"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Relationship"
                  }
                }
              },
              "text/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Relationship"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/relationships": {
      "get": {
        "tags": ["Relationships"],
        "summary": "Get all relationships between digital twins.",
        "operationId": "GetAllRelationships",
        "parameters": [
          {
            "name": "pageNumber",
            "in": "query",
            "description": "The page number. Default:1",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": 1
            }
          },
          {
            "name": "pageSize",
            "in": "query",
            "description": "The page size. Default:100",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": 100
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/RelationshipPaginatedResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RelationshipPaginatedResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/RelationshipPaginatedResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Relationships"],
        "summary": "Create new relationship between digital twins.\r\nCurrently no checks regarding existence of referenced twins is made!",
        "operationId": "CreateRelationship",
        "requestBody": {
          "description": "The relationship.",
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/Relationship"
              }
            },
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Relationship"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Relationship"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Relationship"
              }
            }
          }
        },
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/relationships/{relationshipId}": {
      "get": {
        "tags": ["Relationships"],
        "summary": "Get single relationship between digital twins by relationship id.",
        "operationId": "GetRelationshipById",
        "parameters": [
          {
            "name": "relationshipId",
            "in": "path",
            "description": "The relationship identifier.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Relationships"],
        "summary": "Create or update relationship between digital twins.\r\nurrently no checks regarding existence of referenced twins is made!",
        "operationId": "UpsertRelationship",
        "parameters": [
          {
            "name": "relationshipId",
            "in": "path",
            "description": "The relationship identifier.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "The relationship.",
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/Relationship"
              }
            },
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Relationship"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/Relationship"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/Relationship"
              }
            }
          }
        },
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/Relationship"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Relationships"],
        "summary": "Delete relationship of digital twins (if exists).",
        "operationId": "DeleteRelationship",
        "parameters": [
          {
            "name": "relationshipId",
            "in": "path",
            "description": "The relationship identifier.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success"
          }
        }
      }
    },
    "/twins": {
      "get": {
        "tags": ["Twins"],
        "summary": "Get all digital twins.",
        "operationId": "GetAllTwins",
        "parameters": [
          {
            "name": "pageNumber",
            "in": "query",
            "description": "The page number. Default:1",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": 1
            }
          },
          {
            "name": "pageSize",
            "in": "query",
            "description": "The page size. Default:100",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": 100
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwinPaginatedResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwinPaginatedResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwinPaginatedResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Twins"],
        "summary": "Create digital twin.",
        "operationId": "CreateTwin",
        "requestBody": {
          "description": "The digital twin.",
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalTwin"
              }
            },
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalTwin"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalTwin"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalTwin"
              }
            }
          }
        },
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              }
            }
          }
        }
      }
    },
    "/model/{dtmi}": {
      "get": {
        "tags": ["Twins"],
        "summary": "Get all digital twins of certain model type.",
        "operationId": "GetTwinsByModelId",
        "parameters": [
          {
            "name": "dtmi",
            "in": "path",
            "description": "The digital twin model identifier (DTMI).",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "pageNumber",
            "in": "query",
            "description": "The page number. Default:1",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": 1
            }
          },
          {
            "name": "pageSize",
            "in": "query",
            "description": "The page size. Default:100",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": 100
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwinPaginatedResponse"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwinPaginatedResponse"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwinPaginatedResponse"
                }
              }
            }
          }
        }
      }
    },
    "/twins/{dtid}": {
      "get": {
        "tags": ["Twins"],
        "summary": "Get single digital twin by id.",
        "operationId": "GetTwinById",
        "parameters": [
          {
            "name": "dtid",
            "in": "path",
            "description": "The digital twin identifier.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Twins"],
        "summary": "Create or update digital twin.",
        "operationId": "UpsertTwin",
        "parameters": [
          {
            "name": "dtid",
            "in": "path",
            "description": "The digital twin identifier.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "requestBody": {
          "description": "The digital twin.",
          "content": {
            "application/json-patch+json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalTwin"
              }
            },
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalTwin"
              }
            },
            "text/json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalTwin"
              }
            },
            "application/*+json": {
              "schema": {
                "$ref": "#/components/schemas/DigitalTwin"
              }
            }
          }
        },
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/DigitalTwin"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationProblemDetails"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Twins"],
        "summary": "Delete digital twin (if exists) and all its relationsips.",
        "operationId": "DeleteTwin",
        "parameters": [
          {
            "name": "dtid",
            "in": "path",
            "description": "The digital twin identifier.",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid"
            }
          }
        ],
        "responses": {
          "401": {
            "description": "Unauthorized",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "500": {
            "description": "Server Error",
            "content": {
              "text/plain": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              },
              "text/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProblemDetails"
                }
              }
            }
          },
          "200": {
            "description": "Success"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "DigitalTwin": {
        "type": "object",
        "properties": {
          "$dtId": {
            "type": "string",
            "format": "uuid"
          },
          "$etag": {
            "type": "string",
            "nullable": true
          },
          "$metadata": {
            "$ref": "#/components/schemas/DigitalTwinMetadata"
          }
        },
        "additionalProperties": {}
      },
      "DigitalTwinMetadata": {
        "type": "object",
        "properties": {
          "$model": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "DigitalTwinPaginatedResponse": {
        "type": "object",
        "properties": {
          "totalElements": {
            "type": "integer",
            "format": "int64"
          },
          "content": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DigitalTwin"
            },
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "ProblemDetails": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "nullable": true
          },
          "title": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "detail": {
            "type": "string",
            "nullable": true
          },
          "instance": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": {}
      },
      "Relationship": {
        "type": "object",
        "properties": {
          "$relationshipId": {
            "type": "string",
            "format": "uuid"
          },
          "$etag": {
            "type": "string",
            "nullable": true
          },
          "$sourceId": {
            "type": "string",
            "format": "uuid"
          },
          "$targetId": {
            "type": "string",
            "format": "uuid"
          },
          "$relationshipName": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": {}
      },
      "RelationshipPaginatedResponse": {
        "type": "object",
        "properties": {
          "totalElements": {
            "type": "integer",
            "format": "int64"
          },
          "content": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Relationship"
            },
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "TwinGraph": {
        "type": "object",
        "properties": {
          "digitalTwins": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/DigitalTwin"
            },
            "nullable": true
          },
          "relationships": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Relationship"
            },
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "TwinGraphFile": {
        "type": "object",
        "properties": {
          "digitalTwinsFileInfo": {
            "$ref": "#/components/schemas/TwinGraphFileInfo"
          },
          "digitalTwinsGraph": {
            "$ref": "#/components/schemas/TwinGraph"
          }
        },
        "additionalProperties": false
      },
      "TwinGraphFileInfo": {
        "type": "object",
        "properties": {
          "fileVersion": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": false
      },
      "TwinGraphQuery": {
        "type": "object",
        "properties": {
          "startNodeDtId": {
            "type": "string",
            "nullable": true
          },
          "relationshipFilter": {
            "type": "string",
            "nullable": true
          },
          "labelFilter": {
            "type": "string",
            "nullable": true
          },
          "maxDepth": {
            "type": "integer",
            "format": "int32"
          }
        },
        "additionalProperties": false
      },
      "ValidationProblemDetails": {
        "type": "object",
        "properties": {
          "errors": {
            "type": "object",
            "additionalProperties": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "nullable": true
          },
          "type": {
            "type": "string",
            "nullable": true
          },
          "title": {
            "type": "string",
            "nullable": true
          },
          "status": {
            "type": "integer",
            "format": "int32",
            "nullable": true
          },
          "detail": {
            "type": "string",
            "nullable": true
          },
          "instance": {
            "type": "string",
            "nullable": true
          }
        },
        "additionalProperties": {}
      }
    },
    "securitySchemes": {
      "OAuth2": {
        "type": "oauth2",
        "flows": {
          "authorizationCode": {
            "authorizationUrl": "https://auth.dev.dataspace-hub.com/auth/realms/dev-node-a/protocol/openid-connect/auth",
            "tokenUrl": "https://auth.dev.dataspace-hub.com/auth/realms/dev-node-a/protocol/openid-connect/token",
            "scopes": {
              "profile": "profile",
              "email": "email",
              "twin-api": "twin-api",
              "catalog-api": "catalog-api"
            }
          }
        }
      }
    }
  },
  "security": [
    {
      "OAuth2": ["profile", "email", "twin-api", "catalog-api"]
    }
  ]
}
